if(!window.Msn)window.Msn={};if(!window.Msn.Video)window.Msn.Video=new function(){};Msn.Video._loaded=null;Msn.Video.OnVideoTitle=function(b,a){a=a+"_t";if(checkString(b)&&checkString(a)){var c=document.getElementById(a);if(c)c.innerHTML=b}};Msn.Video.OnMediaCompleted=function(a){a=a+"_t";var b=document.getElementById(a);if(b)b.innerHTML=""};Msn.Video.OnLinkback=function(b,f,d){d=d+"_m";var a,c=document.getElementById(d),e;if(c){c.innerHTML="";for(a=0;a<=b.length-1;a++)if(checkString(b[a])&&checkString(f[a])){e=a==b.length-1?"linkback last":"linkback";c.innerHTML=c.innerHTML+'<a class="'+e+'" href="'+f[a]+'" target="_blank">'+b[a]+"</a>"}}};Msn.Video.EVENT_FLASH_DETECT="flash_detect";function isIE(){return navigator.userAgent.toLowerCase().indexOf("msie")!=-1}function checkDefined(a){return typeof a!="undefined"&&null!=a}function checkString(a){return typeof a=="string"&&a.length>0}function checkObject(a){return typeof a=="object"&&null!=a}function checkArray(c,b){var a=c instanceof Array;if(b!="")a=a&&c.length>=b;returnarrayCheck}function checkFunction(a){return typeof a=="function"}function parseBool(a){return typeof a!="undefined"&&null!=a&&a.toLowerCase()=="true"}function checkInt(a,c,b){if(null!=a&&(typeof a!="string"||""!=a)&&!isNaN(a)){if(checkDefined(c)&&a<c)return false;if(checkDefined(b)&&a>b)return false;return true}return false}function openStandardWindow(b,a){return openWindow(b,a,1024,768,"resizable=yes,toolbar=yes,menubar=yes,scrollbars=yes,status=yes,location=yes")}function padLeft(d,c,b){var a=""+d;while(a.length<c)a=b+a;return a}Msn.Video.FlashObject=function(u,v,r,q,s){var g="menu",f="base",h="bgColor",e="wmode",c=null,d=this,t=d,y=[],x=[],a=c,i=c,w=false,j=u,p=v,b=s,k=false,m=0,n=0,l=0,o;b=b||{};if(b[e]==undefined)b[e]="transparent";if(b[h]==undefined)b[h]="#000000";if(b[f]==undefined)b[f]=".";if(b[g]==undefined)b[g]="false";Msn.Video.FlashVersionDetectInstance.addListener(d);d.onEvent=function(c,a){switch(a){case Msn.Video.EVENT_FLASH_DETECT:if(!Msn.Video.FlashVersionDetectInstance.checkVersion(m,n,l))this.onVersionDetectionFailure()}};d.getObjectNode=function(){return a};d.setInstallCtrl=function(d,b,c,a){if(d!=undefined)i=d;m=b!=undefined?b:0;n=c!=undefined?c:0;l=a!=undefined?a:0};d.onDispose=function(){if(isIE())try{for(var b in a)if(checkFunction(a[b]))a[b]=empty}catch(d){}a=c};d.onVersionDetectionFailure=function(){k=true;this.render(o)};d.verifyIEInstall=function(){var a=document.getElementById(j);if(a.allowScriptAccess==undefined)t.onVersionDetectionFailure()};d.render=function(s){var t="flashvars",d='">';o=s;o.innerHTML="";if(c!=s&&checkString(p)){if(Msn.Video.FlashVersionDetectInstance&&!Msn.Video.FlashVersionDetectInstance.checkVersion(m,n,l))k=true;if(k&&i)i.render(s);else if(isIE()){s.innerHTML='<object id="'+j+'" '+'name="'+j+'" '+'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" '+'height="'+q+'" '+'width="'+r+'"> '+'<param name="movie" value="'+p+d+'<param name="flashvars" value="'+b[t]+'"/> '+'<param name="menu" value="'+b[g]+d+'<param name="wmode" value="'+b[e]+d+'<param name="play" value="0">'+'<param name="quality" value="High">'+'<param name="allowScriptAccess" value="always">'+'<param name="allowFullScreen" value="true">'+'<param name="bgcolor" value="'+b[h]+d+'<param name="base" value="'+b[f]+d+"</object>";a=s.childNodes[0];if(i)setTimeout(this.verifyIEInstall,1e3)}else{a=document.createElement("EMBED");a.id=j;a.setAttribute("name",j);a.setAttribute("bgcolor",b[h]);a.setAttribute("allowScriptAccess","always");a.setAttribute(g,b[g]);a.setAttribute("quality","high");a.setAttribute("type","application/x-shockwave-flash");a.setAttribute("src",p);a.setAttribute("width",r);a.setAttribute("height",q);a.setAttribute("flashVars",b[t]);a.setAttribute(e,b[e]);a.setAttribute(f,b[f]);a.setAttribute("allowFullScreen","true");s.appendChild(a);if(i&&!(navigator.plugins!=c&&navigator.plugins.length>0&&(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"])))this.onVersionDetectionFailure()}}else a=c}};Msn.Video.FlashVersionDetect=function(){var a=this,f=a,c,d,e,b=[];if(!checkDefined(Msn.Video.FlashVersionDetectInstance))Msn.Video.FlashVersionDetectInstance=a;a.addListener=function(a){b.push(a)};a.fireEvent=function(e,c,d){for(var a=0;a<b.length;a++)if(checkDefined(b[a])&&checkFunction(b[a].onEvent))b[a].onEvent(this,e,c,d)};a.render=function(b){if(null!=b){b.style.position="absolute";var h="versiondetect",i="http://images.video.msn.com/flash/versionDetect.swf",g=new Msn.Video.FlashObject(h,i,1,1);g.render(b);var a=g.getObjectNode();if(a){if(a.attachEvent)a.attachEvent("fscommand",f.onVersion);window[h+"_DoFSCommand"]=f.onVersion}else c=d=e=0}};a.checkVersion=function(a,b,f){if(c>a||c==undefined)return true;else if(c==a)if(d>b||d==undefined)return true;else if(d==b&&(e>=f||e==undefined))return true;return false};a.onVersion=function(b){try{var a=b.split(" ")[1];a=a.split(",");c=checkInt(a[0])?a[0]:0;d=checkInt(a[1])?a[1]:0;e=checkInt(a[2])?a[2]:0;f.fireEvent(Msn.Video.EVENT_FLASH_DETECT,b)}catch(g){}}};Msn.Video.FlashInstall=function(e){var b="_blank",c=this,a=c,d=e;c.cfg={REQUIRE_FLASH:"Please install the latest version of the free Adobe Flash Player. ",REQUIRE_FLASH_LINK:"Download now.",HELP_FLASH:"For help with Flash, see Adobe's ",HELP_FLASH_LINK:"Flash Player Support page.",FLASH_INSTALL_URL:"http://g.msn.com/0VD0/34/67?CM=not_auto_flash",FLASH_HELP_URL:"http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_15511"};c.onFlashInstall=function(){setTimeout(a.onFlashInstallComplete,1e3)};c.onFlashInstallComplete=function(){openStandardWindow(a.cfg.FLASH_INSTALL_URL,b)};c.render=function(h){if(null!=h)if(checkDefined(d))h.appendChild(d);else{var g=document.createElement("DIV");g.className="flashInstallParent";h.appendChild(g);var c=document.createElement("DIV");c.className="flashInstall";c.style.backgroundColor="#e0e0e0";c.style.color="#666";c.style.fontFamily="Tahoma";c.style.fontSize="8pt";c.style.fontWeight="bold";c.style.padding="30px";g.appendChild(c);var f=document.createElement("span");f.innerHTML=a.cfg.REQUIRE_FLASH;c.appendChild(f);var e=document.createElement("a");e.setAttribute("href",a.cfg.FLASH_INSTALL_URL);e.setAttribute("target",b);e.innerHTML=a.cfg.REQUIRE_FLASH_LINK;e.style.color="#07519a";c.appendChild(e);c.appendChild(document.createElement("BR"));c.appendChild(document.createElement("BR"));f=document.createElement("span");f.innerHTML=a.cfg.HELP_FLASH;c.appendChild(f);e=document.createElement("a");e.setAttribute("href",a.cfg.FLASH_HELP_URL);e.setAttribute("target",b);e.innerHTML=a.cfg.HELP_FLASH_LINK;e.style.color="#07519a";c.appendChild(e)}}};if(!window.Silverlight)window.Silverlight={};Silverlight._silverlightCount=0;Silverlight.__onSilverlightInstalledCalled=false;Silverlight.fwlinkRoot="http://go2.microsoft.com/fwlink/?LinkID=";Silverlight.__installationEventFired=false;Silverlight.onGetSilverlight=null;Silverlight.onSilverlightInstalled=function(){window.location.reload(false)};Silverlight.isInstalled=function(d){var b=true,c=null;if(d==undefined)d=c;var a=false,o=c;try{var k=c,l=false;if(window.ActiveXObject)try{k=new ActiveXObject("AgControl.AgControl");if(d===c)a=b;else if(k.IsVersionSupported(d))a=b;k=c}catch(n){l=b}else l=b;if(l){var m=navigator.plugins["Silverlight Plug-In"];if(m)if(d===c)a=b;else{var j=m.description;if(j==="1.0.30226.2")j="2.0.30226.2";var e=j.split(".");while(e.length>3)e.pop();while(e.length<4)e.push(0);var g=d.split(".");while(g.length>4)g.pop();var f,i,h=0;do{f=parseInt(g[h]);i=parseInt(e[h]);h++}while(h<g.length&&f===i);if(f<=i&&!isNaN(f))a=b}}}catch(n){a=false}return a};Silverlight.WaitForInstallCompletion=function(){if(!Silverlight.isBrowserRestartRequired&&Silverlight.onSilverlightInstalled){try{navigator.plugins.refresh()}catch(a){}if(Silverlight.isInstalled(null)&&!Silverlight.__onSilverlightInstalledCalled){Silverlight.onSilverlightInstalled();Silverlight.__onSilverlightInstalledCalled=true}else setTimeout(Silverlight.WaitForInstallCompletion,3e3)}};Silverlight.__startup=function(){navigator.plugins.refresh();Silverlight.isBrowserRestartRequired=Silverlight.isInstalled(null);if(!Silverlight.isBrowserRestartRequired){Silverlight.WaitForInstallCompletion();if(!Silverlight.__installationEventFired){Silverlight.onInstallRequired();Silverlight.__installationEventFired=true}}else if(window.navigator.mimeTypes){var b=navigator.mimeTypes["application/x-silverlight-2"],c=navigator.mimeTypes["application/x-silverlight-2-b2"],d=navigator.mimeTypes["application/x-silverlight-2-b1"],a=d;if(c)a=c;if(!b&&(d||c)){if(!Silverlight.__installationEventFired){Silverlight.onUpgradeRequired();Silverlight.__installationEventFired=true}}else if(b&&a)if(b.enabledPlugin&&a.enabledPlugin)if(b.enabledPlugin.description!=a.enabledPlugin.description)if(!Silverlight.__installationEventFired){Silverlight.onRestartRequired();Silverlight.__installationEventFired=true}}if(!Silverlight.disableAutoStartup)if(window.removeEventListener)window.removeEventListener("load",Silverlight.__startup,false);else window.detachEvent("onload",Silverlight.__startup)};if(!Silverlight.disableAutoStartup)if(window.addEventListener)window.addEventListener("load",Silverlight.__startup,false);else window.attachEvent("onload",Silverlight.__startup);Silverlight.createObject=function(n,f,e,l,m,h,k){var d={},a=l,c=m;d.version=a.version;a.source=n;d.alt=a.alt;if(h)a.initParams=h;if(a.isWindowless&&!a.windowless)a.windowless=a.isWindowless;if(a.framerate&&!a.maxFramerate)a.maxFramerate=a.framerate;if(e&&!a.id)a.id=e;delete a.ignoreBrowserVer;delete a.inplaceInstallPrompt;delete a.version;delete a.isWindowless;delete a.framerate;delete a.data;delete a.src;delete a.alt;if(Silverlight.isInstalled(d.version)){for(var b in c)if(c[b]){if(b=="onLoad"&&typeof c[b]=="function"&&c[b].length!=1){var i=c[b];c[b]=function(a){return i(document.getElementById(e),k,a)}}var g=Silverlight.__getHandlerName(c[b]);if(g!=null){a[b]=g;c[b]=null}else throw"typeof events."+b+" must be 'function' or 'string'"}slPluginHTML=Silverlight.buildHTML(a)}else if(Silverlight.isInstalled("3.0")||Silverlight.isInstalled("2.0")||Silverlight.isInstalled("1.0")){slPluginHTML=Silverlight.buildPromptHTML(d);var j=confirm("This page requires a more recent version of Silverlight. Would you like to install the latest version of Silverlight?");if(j)Silverlight.getSilverlight()}else slPluginHTML=Silverlight.buildPromptHTML(d);if(f)f.innerHTML=slPluginHTML;else return slPluginHTML};Silverlight.buildHTML=function(a){var b=[];b.push('<object type="application/x-silverlight" data="data:application/x-silverlight,"');if(a.id!=null)b.push(' id="'+Silverlight.HtmlAttributeEncode(a.id)+'"');if(a.width!=null)b.push(' width="'+a.width+'"');if(a.height!=null)b.push(' height="'+a.height+'"');b.push(" >");delete a.id;delete a.width;delete a.height;for(var c in a)if(a[c])b.push('<param name="'+Silverlight.HtmlAttributeEncode(c)+'" value="'+Silverlight.HtmlAttributeEncode(a[c])+'" />');b.push("</object>");return b.join("")};Silverlight.createObjectEx=function(b){var a=b,c=Silverlight.createObject(a.source,a.parentElement,a.id,a.properties,a.events,a.initParams,a.context);if(a.parentElement==null)return c};Silverlight.buildPromptHTML=function(b){var a="",d=Silverlight.fwlinkRoot,c=b.version;if(b.alt)a=b.alt;else{if(!c)c="";a="<a href='javascript:Silverlight.getSilverlight(\"{1}\");' style='text-decoration: none;'><img src='{2}' alt='Get Microsoft Silverlight' style='border-style: none'/></a>";a=a.replace("{1}",c);a=a.replace("{2}",d+"108181")}return a};Silverlight.getSilverlight=function(e){if(Silverlight.onGetSilverlight)Silverlight.onGetSilverlight();var b="",a=String(e).split(".");if(a.length>1){var c=parseInt(a[0]);if(isNaN(c)||c<2)b="1.0";else b=a[0]+"."+a[1]}var d="";if(b.match(/^\d+\056\d+$/))d="&v="+b;Silverlight.followFWLink("114576"+d)};Silverlight.followFWLink=function(a){top.location=Silverlight.fwlinkRoot+String(a)};Silverlight.HtmlAttributeEncode=function(c){var a,b="";if(c==null)return null;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);if(a>96&&a<123||a>64&&a<91||a>43&&a<58&&a!=47||a==95)b=b+String.fromCharCode(a);else b=b+"&#"+a+";"}return b};Silverlight.default_error_handler=function(g,b){var e="Position: ",c="     \n",f,d=b.ErrorType;f=b.ErrorCode;var a="\nSilverlight error message     \n";a+="ErrorCode: "+f+"\n";a+="ErrorType: "+d+"       \n";a+="Message: "+b.ErrorMessage+c;if(d=="ParserError"){a+="XamlFile: "+b.xamlFile+c;a+="Line: "+b.lineNumber+c;a+=e+b.charPosition+c}else if(d=="RuntimeError"){if(b.lineNumber!=0){a+="Line: "+b.lineNumber+c;a+=e+b.charPosition+c}a+="MethodName: "+b.methodName+c}alert(a)};Silverlight.__cleanup=function(){for(var a=Silverlight._silverlightCount-1;a>=0;a--)window["__slEvent"+a]=null;Silverlight._silverlightCount=0;if(window.removeEventListener)window.removeEventListener("unload",Silverlight.__cleanup,false);else window.detachEvent("onunload",Silverlight.__cleanup)};Silverlight.__getHandlerName=function(b){var c="onunload",a="";if(typeof b=="string")a=b;else if(typeof b=="function"){if(Silverlight._silverlightCount==0)if(window.addEventListener)window.addEventListener(c,Silverlight.__cleanup,false);else window.attachEvent(c,Silverlight.__cleanup);var d=Silverlight._silverlightCount++;a="__slEvent"+d;window[a]=b}else a=null;return a};Silverlight.onRequiredVersionAvailable=function(){};Silverlight.onRestartRequired=function(){};Silverlight.onUpgradeRequired=function(){};Silverlight.onInstallRequired=function(){};Silverlight.IsVersionAvailableOnError=function(e,a){var b=true,c=false;try{if(a.ErrorCode==8001&&!Silverlight.__installationEventFired){Silverlight.onUpgradeRequired();Silverlight.__installationEventFired=b}else if(a.ErrorCode==8002&&!Silverlight.__installationEventFired){Silverlight.onRestartRequired();Silverlight.__installationEventFired=b}else if(a.ErrorCode==5014||a.ErrorCode==2106){if(Silverlight.__verifySilverlight2UpgradeSuccess(a.getHost()))c=b}else c=b}catch(d){}return c};Silverlight.IsVersionAvailableOnLoad=function(b){var a=false;try{if(Silverlight.__verifySilverlight2UpgradeSuccess(b.getHost()))a=true}catch(c){}return a};Silverlight.__verifySilverlight2UpgradeSuccess=function(d){var c=false,b="2.0.31005",a=null;try{if(d.IsVersionSupported(b+".99")){a=Silverlight.onRequiredVersionAvailable;c=true}else if(d.IsVersionSupported(b+".0"))a=Silverlight.onRestartRequired;else a=Silverlight.onUpgradeRequired;if(a&&!Silverlight.__installationEventFired){a();Silverlight.__installationEventFired=true}}catch(e){}return c};if(!window.Msn)window.Msn={};if(!window.Msn.VideoSL)window.Msn.VideoSL={};Msn.VideoSL.Inline=function(f){var g="function",a=null,d=this,e=d,q=f+"_t",p=f+"_p",o=f+"_m",n=f+"_a",i=f+"_pobj",b,c,h;d.Build=function(f,g,d,c,a,b){e.BuildPlayer(f,g,d,c,a,b)};d.BuildPlayer=function(f,q,o,n,m,s){var k="windowless",j="background",g="true",l={ifs:g,playlistmin:"2"},d;for(d in f)l[d]=f[d];f=[];for(d in l)if(l[d])f.push(d+"="+l[d].replace(/,/g,"%2C"));f=f.join(",");var h={width:q?q:300,height:o?o:269,framerate:"30",version:"4.0.50401",enableHtmlAccess:g,enableGPUAcceleration:g};for(var r in m)h[r]=m[r];if(undefined==h[j])h[j]="black";if(undefined==h[k])h[k]="false";b=s;var t={source:n?n:"http://images.video.msn.com/sl/inline.xap",parentElement:document.getElementById(p),id:i,properties:h,events:{onLoad:e.OnLoad,onError:e.OnError},initParams:f,context:a};Silverlight.createObjectEx(t);c=setTimeout(e.OnLoad,100)};d.OnLoad=function(o,n,m){if(c!=a){clearTimeout(c);c=a}var d=document.getElementById(i);if(d!=a&&d.IsLoaded){if(!h){h=true;var f=d.Content.Inline;f.addEventListener("PropertyChanged",l);k(f.Title);j(f.Links);if(b!=a&&typeof b.onLoad==g)b.onLoad(o,n,m)}}else c=setTimeout(e.OnLoad,100)};d.OnError=function(d,c){if(b!=a&&typeof b.onError==g)b.onError(d,c)};function l(d,c){var a=c.PropertyName,b=c.PropertyValue;if(a=="Title")k(b);if(a=="Banner")m(b);if(a=="Links")j(b)}function k(c){var b=document.getElementById(q);if(b)b.innerHTML=c==a?"":c}function m(b){var c=document.getElementById(n);if(c)c.innerHTML=b==a?"":'<a class="ad" href="'+b.Target+'" target="_blank"><img src="'+b.Image+'" width="300" height="60"></a>'}function j(c){var i=document.getElementById(o),b,f,h="";if(i){for(b=0;c!=a&&b<=c.length-1;b++){f=b==c.length-1?"linkback last":"linkback";var e,d;try{e=c[b].url;d=c[b].text}catch(g){e=c[b].Uri.ToString();d=c[b].Value}try{h+='<a class="'+f+'" href="'+e+'" target="_blank">'+d+"</a>"}catch(g){alert(f);alert(e);alert(d);alert(h);alert(g);debugger}}i.innerHTML=h}}};Msn.Video.Widgets={playerarticle:{current:{path:"flash/inline.swf"}},playeroverlay:{current:{path:"flash/inline.swf"}},player:{"2":{path:"flash/soapbox1_1.swf",oldRoot:true},current:{path:"flash/inline.swf"}},playerrtl:{current:{path:"flash/soapbox1_1RTL.swf",oldRoot:true}},playerad:{"2":{path:"flash/soapbox1_1.swf",oldRoot:true},current:{path:"flash/inline.swf"}},slplayer:{current:{path:"sl/inlinev2.xap"},silverlight:true},slplayerad:{current:{path:"sl/inlinev2.xap"},silverlight:true},gallery:{"2":{path:"flash/gallerywidget/1_0/gallerywidget.swf",oldRoot:true},current:{path:"flash/gallerywidget/1_0/gallerywidget.swf"}},galleryrtl:{current:{path:"flash/gallerywidget/1_0/gallerywidget.swf",oldRoot:true}},customplayer:{"2":{path:"flash/customplayer/1_0/customplayer.swf",oldRoot:true},current:{path:"flash/customplayer/1_0/customplayer.swf"}}};Msn.Video.createWidget=function(f,h,j,i,b,c,e,d,g,a){Msn.Video.createWidget2({divId:f,src:h,w:j,h:i,flashvars:b,widgetId:c,params:e,version:d,root:g,downlevel:a})};Msn.Video.createWidget2=function(a){var b=document.getElementById(a.divId);a.src=a.src.toLowerCase();if(checkDefined(b)&&checkDefined(Msn.Video.Widgets[a.src]))Msn.Video.renderWidget(null,a,null)};Msn.Video.loadConfiguration=function(a,f,h,i){var c="",d="",e="";if(checkDefined(a.flashvars)){var b=new Msn.Video.ConfigMgr(null,a.flashvars);c=b.getValue("mkt",c);d=b.getValue("configCsid","");e=b.getValue("configName","")}var j=Msn.Video.UrlHelper.getWERoot(a),g=j+"/resource.aspx?resources="+f+"&gmts="+h+"&mkt="+c+"&configCsid="+d+"&configName="+e+"&responseEncoding=json";Msn.Video.JavascriptApi.makeRequest(g,a,i)};Msn.Video.renderWidget=function(m,a){var b=document.getElementById(a.divId),f=a.src.toLowerCase();switch(f){case "player":case "playerad":case "slplayer":case "slplayerad":var j=new Msn.Video.Player;j.create(a,b);break;case "playerarticle":var g=new Msn.Video.ArticlePlayer;g.create(a,b);break;case "playeroverlay":var h=new Msn.Video.OverlayPlayer;h.create(a,b);break;case "gallery":var i=new Msn.Video.Gallery;i.create(a,b);break;default:var c=document.createElement("div");c.setAttribute("id",a.divId+"_content");b.appendChild(c);var d={};for(var e in a.flashvars)if(null!=a.flashvars[e])d[e]=a.flashvars[e].replace(/\&/g,"%26");a.params=a.params||{};var k=Msn.Video.Widgets[a.src].silverlight==true;a.src=Msn.Video.getWidgetEmbedAsset(a);if(k)Msn.Video.buildSLWidget(f,b,c,a,d);else return Msn.Video.buildFlashWidget(b,c,a,d)}};Msn.Video.buildSLWidget=function(g,h,f,a,d){var b={};for(var e in d)b[e]=decodeURIComponent(d[e]).replace(/\,/g,"%2c");var c=new Msn.VideoSL.Inline(a.divId);if(g=="slplayerad")c.Build(b,a.w,a.h,a.src,a.params);else{f.innerHTML="<div id='"+a.divId+"_p'></div>";c.BuildPlayer(b,a.w,a.h,a.src,a.params)}};Msn.Video.buildFlashWidget=function(g,f,a,e){var d="";for(i in e)d+=i+"="+e[i]+"&";a.params["flashvars"]=d;var h=new Msn.Video.FlashVersionDetect,c=new Msn.Video.FlashObject(a.widgetId||a.divId+"_flash",a.src,a.w,a.h,a.params);c.setInstallCtrl(new Msn.Video.FlashInstall(a.downlevel),9);var b=document.createElement("div");b.setAttribute("id",a.divId+"_detect");g.appendChild(b);h.render(b);c.render(f);return c.getObjectNode()};Msn.Video.getWidgetEmbedAsset=function(a){var c=a.src.toLowerCase(),g=Msn.Video.Widgets[c].silverlight==true,b=a.flashvars["version"];if(!b||!Msn.Video.Widgets[c][b])b="current";var f=Msn.Video.Widgets[c][b],d=f.oldRoot?getCreateWidgetParamValue(a,"root","images.video.msn.com"):Msn.Video.UrlHelper.getWERoot(a);d=normalizeRootUrl(d);var e=d+"/"+f.path;if(a.cacheBuster)e+="?rand="+Math.random();return e};Msn.Video.buildPlayerAdElements=function(c,a){var d='<div class="video1"><h3 id="'+a+'_t"></h3><div id="'+a+'_p"></div><div id="'+a+'_m"></div><div id="'+a+'_a" class="playerAdDiv"></div><div id="'+a+'_r"></div></div>';c.innerHTML=d;var b=document.getElementById(a+"_p");return b};function getCreateWidgetParamValue(a,b,d){var c=d;if(a.hasOwnProperty(b)&&checkDefined(a[b]))c=a[b];return c}function normalizeRootUrl(a){if(a){if(a.indexOf("http://")!=0)a="http://"+a;if(a.lastIndexOf("/")==a.length-1)a=a.substring(0,a.length-1)}return a}Msn.Video._loaded=(new Date).getTime();Msn.Video.UrlHelper=new function(){var a=this;a.getWRoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"wRoot","widgets.video.msn.com"))};a.getWERoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"weRoot","img.widgets.video.s-msn.com"))};a.getvceRoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"vceRoot","catalog.video.msn.com"))};a.getVCERoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"vceRoot","edge1.catalog.video.msn.com"))};a.getVCImgRoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"vciRoot","img1.catalog.video.msn.com"))}};if(!Msn.Video.JavascriptApi)Msn.Video.JavascriptApi=new function(){var a=this,d=a,c=0,b={};a.makeRequest=function(f,d,e){var a=c++;b[a]={context:d,funcCb:e};this.fetchScript(f+"&callbackName=Msn.Video.JavascriptApi.onComplete&cd="+a,a)};a.fetchScript=function(c,d){var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",c);a.setAttribute("id",d);var b=document.getElementsByTagName("head")[0];b.appendChild(a)};a.onComplete=function(g,a,e){var f=b[a].context,d=b[a].funcCb;d(g,f,e);var c=document.getElementById(a);if(checkDefined(c))setTimeout(function(){var a=document.getElementsByTagName("head")[0];a.removeChild(c)},0)}};Msn.Video.ResourceMgr=function(f,c){var e=this,b="default",a={};function d(a,f){if(checkDefined(f))b=f;if(a)for(var c=0;c<a.length;c++){var j=a[c].Key.toLowerCase(),h=a[c].Value;for(var d=0;d<h.length;d++){var g=h[d],i=g.Key.toLowerCase();e.setValue(j,i,g.Value)}}}this.getValue=function(b,c,e){var d=e;b=b.toLowerCase();c=c.toLowerCase();if(a.hasOwnProperty(b)&&a[b].hasOwnProperty(c))d=a[b][c];return d};this.setValue=function(d,e,g){if(null==d||d=="default")d=b;d=d.toLowerCase();e=e.toLowerCase();var f=e.indexOf(".");if(d==c&&f>0){d=e.substring(0,f);e=e.substr(f+1)}if(!a.hasOwnProperty(d))a[d]={};a[d][e]=g};d(f,c)};Msn.Video.ConfigMgr=function(f,e,c){var a="default",b;function d(f,d,c){b=new Msn.Video.ResourceMgr(f,c);if(checkDefined(c))a=c;for(var e in d)b.setValue(null,e,d[e])}d(f,e,c);this.getValue=function(d,c,e){if(arguments.length==2){e=c;c=d;d=a}val=b.getValue(d,c,e);return val};this.setValue=function(c,d,e){if(arguments.length==2){e=d;d=c;c=a}if(c=="default")c=a;b.setValue(c,d,e)}};Msn.Video.Player=function(){var h="slplayerad",g="playerad",e="true",d="false",b="player",m=this,a,c,k,i;this.create=function(d,c){a=d;i=c;if(!checkDefined(a.cfgMgr)||!checkDefined(a.resMgr))Msn.Video.loadConfiguration(a,b,"gmt",j);else j(null,a,null)};function l(){var i="slplayer",f;switch(c.getValue("leadwithplugin","").toLowerCase()){case "silverlight":f=true;break;case "flash":f=false;break;default:f=c.getValue("gmt","leadWithSilverlight",d).toLowerCase()==e}if(f)switch(a.src){case b:a.src=i;break;case g:a.src=h}if(!Silverlight.isInstalled("4.0")&&c.getValue("downlevel","").toLowerCase()!="install")switch(a.src){case i:a.src=b;break;case h:a.src=g}}function j(x,y){var u="transparent",q="background",m="windowless",o="wmode",n="mode",p="adDivs",t="leadwithimage";c=y.cfgMgr||new Msn.Video.ConfigMgr(x.configs,a.flashvars,b);k=y.resMgr||new Msn.Video.ResourceMgr(x.resources);var v=c.getValue(t,d).toLowerCase();if(v&&(v==e||v=="yes")){c.setValue(t,d);a.cfgMgr=c;a.resMgr=k;var z=new Msn.Video.LeadWithImage;z.create(a,i)}else{l();var s=a.src.toLowerCase(),r=document.createElement("div");r.setAttribute("id",a.divId+"_content");i.appendChild(r);var j={};for(var w in a.flashvars)if(null!=a.flashvars[w])j[w]=a.flashvars[w].replace(/\&/g,"%26");if(s==g||s==h){r=Msn.Video.buildPlayerAdElements(r,a.divId);j["cbprefix"]="Msn.Video.";j["cbdata"]=a.divId;j[p]=(checkString(j[p])?j[p]+";":"")+a.divId+"_a|300|60"}if(s.substring(0,6)==b&&!checkString(j[n]))j[n]=checkString(j[n])?j[n]:"inline";a.params=a.params||{};var A=checkDefined(Msn.Video.Widgets[s].silverlight)?Msn.Video.Widgets[s].silverlight==true:false;a.src=Msn.Video.getWidgetEmbedAsset(a);f(o,a,c.getValue(o,undefined));f(m,a,c.getValue(m,undefined));f(q,a,c.getValue(q,undefined));if(undefined!=a.params[o])switch(a.params[o].toLowerCase()){case u:f(m,a,e);f(q,a,u);break;case "opaque":f(m,a,e);break;case "window":f(m,a,d)}if(A)Msn.Video.buildSLWidget(s,i,r,a,j);else return Msn.Video.buildFlashWidget(i,r,a,j)}}function f(b,a,c){if(!a.params[b])a.params[b]=c}};Msn.Video.Gallery=function(){var b=null,h=this,a,d,g,f,c;this.create=function(g,d){a=g;c=d;f=a.widgetId;if(!checkDefined(a.cfgMgr)||!checkDefined(a.resMgr))Msn.Video.loadConfiguration(a,"gallery","gmt",e);else e(b,a,b)};function e(l,m){var e="wmode";d=m.cfgMgr||new Msn.Video.ConfigMgr(l.configs,a.flashvars,"gallery");g=m.resMgr||new Msn.Video.ResourceMgr(l.resources);var o=a.src.toLowerCase(),i=document.createElement("div");i.setAttribute("id",a.divId+"_content");c.appendChild(i);var j={};for(var k in a.flashvars)if(b!=a.flashvars[k])j[k]=a.flashvars[k].replace(/\&/g,"%26");a.params=a.params||{};a.src=Msn.Video.getWidgetEmbedAsset(a);if(d.getValue("playtype","inline")=="overlay"){var h=document.createElement("DIV");h.id=f+"OverlayPlayer";c.appendChild(h);var n=d.getValue("widgetGroup",b);Msn.Video.createWidget2({divId:h.id,src:"playeroverlay",w:300,h:300,flashvars:{widgetGroup:n},widgetId:h.id,weRoot:a.weRoot,cacheBuster:a.cacheBuster});j["gallery.playType"]="inline"}if(!a.params[e])a.params[e]=d.getValue(e,"transparent");return Msn.Video.buildFlashWidget(c,i,a,j)}};Msn.Video.ArticlePlayer=function(){var b="DIV",c="player",a=null,t=this,l=a,h,j,o,e,d,i,q,g,k,f;this.create=function(b,d){e=b;q=d;if(!checkDefined(b.cfgMgr)||!checkDefined(b.resMgr))Msn.Video.loadConfiguration(b,c,"gmt",n);else n(a,b,a)};function n(L,M){var n="true",t="false",z="MsnVideoInitializeInternal";d=M.cfgMgr||new Msn.Video.ConfigMgr(L.configs,e.flashvars,c);i=M.resMgr||new Msn.Video.ResourceMgr(L.resources);h=e.widgetId;j=h+"InternalGroup";if("undefined"!=typeof MsnVideo2&&a!=MsnVideo2)m();else{l=window[z];window[z]=m}var p=d.getValue("compactMode",t);p=a!=p&&p.toLowerCase()==n;var y=d.getValue("showMetadata",n);y=a==y||y.toLowerCase()!=t;var D=document.createElement(b);D.className="msnVideoArticlePlayer";q.appendChild(D);g=document.createElement(b);g.className=p?"compact":"normal";var G=d.getValue("backgroundcolor1",a);if(a!=G)try{g.style.backgroundColor=G}catch(B){alert("backgroundcolor1 configured incorrectly")}D.appendChild(g);k=document.createElement(b);k.className="playerDiv";var I=h+"PlayerDiv";k.id=I;g.appendChild(k);if(y||p){var v=document.createElement(b);v.className="upperDiv";f=document.createElement(b);f.className="metadataDiv";var C=d.getValue("fontcolor1",a);if(a!=C)try{f.style.color=C}catch(B){alert("fontcolor1 configured incorrectly")}v.appendChild(f);g.appendChild(v)}if(!p){var H=d.getValue("showBottomArea",n),r=a;if(a==H||H.toLowerCase()!=t){r=document.createElement(b);r.className="bottomDiv";var F=d.getValue("backgroundcolor2",a);if(a!=F)try{r.style.backgroundColor=F}catch(B){alert("backgroundcolor2 configured incorrectly")}g.appendChild(r);var x=document.createElement(b);x.className="browseMoreDiv";var E=document.createElement("IMG"),Q=Msn.Video.UrlHelper.getWERoot(e);E.src=Q+"/i/articleplayer/arrow.png";E.className="arrow";x.appendChild(E);var w=document.createElement("A"),O="http://video.msn.com?mkt="+d.getValue("mkt","en-us");w.href=d.getValue("linkback",O);if(d.getValue("pl",n).toLowerCase()==n)w.target="_blank";w.appendChild(document.createTextNode(i.getValue(c,"MoreVideosText","Browse more videos")));var P=d.getValue("fontColor3",a);if(a!=C)try{w.style.color=P}catch(B){alert("fontColor3 configured incorrectly")}x.appendChild(w);r.appendChild(x)}}var A=document.createElement(b),J=h+"adDiv";A.id=J;A.className="adDiv";if(p){v.appendChild(A);var K=document.createElement(b);K.className="clear";v.appendChild(K)}else if(a!=r)r.appendChild(A);var u={};for(var N in e.flashvars)u[N]=e.flashvars[N];u["widgetId"]=o;u["adDivs"]=J+"|300|60";u["widgetGroup"]=j;u["rst"]="ArticlePlayer";Msn.Video.createWidget2({divId:I,src:s(),w:e.w,h:e.h,flashvars:u,widgetId:o,root:e.root,weRoot:e.weRoot,vceRoot:e.vceRoot,cacheBuster:e.cacheBuster})}function s(){var a="slplayer";if(d.getValue("leadwithplugin","silverlight").toLowerCase()=="flash")a=c;return a}function p(e){var k=":</span> ",g="</span>",t=d.getValue("fontColor2",a),l="";if(a!=t)l=' style="color: '+t+'"';f.innerHTML="";var q=document.createElement(b);q.className="titleDiv";q.innerHTML=e.title;f.appendChild(q);var p=document.createElement(b);p.className="detailDiv";var r=new Date(e.startDate),x=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear(),s='<div><span class="dateDetail"><span class="detailLabel"'+l+">"+i.getValue(c,"DateLbl","Date")+":</span>"+x+g,j=60*60,h=e.durationSecs,v=Math.floor(h/j);h%=j;j/=60;var u=Math.floor(h/j);h%=j;var y=Math.floor(h),n="";if(v>0)n+=padLeft(v,2,"0")+":";var w=u>0?2:1;n+=padLeft(u,w,"0")+":"+padLeft(y,2,"0");s+='<span class="durationDetail"><span class="detailLabel"'+l+">"+i.getValue(c,"DurationLbl","Duration")+k+n+g;var o;if(e.relatedLinks.length>0&&checkString(e.relatedLinks[0].url))o='<a class="videoByLink" href="'+e.relatedLinks[0].url+'" target="_blank">'+e.sourceFriendly+"</a>";else o=e.sourceFriendly;s+='<span class="sourceDetail"><span class="detailLabel"'+l+">"+i.getValue(c,"VideoByLbl","Video By")+k+o+g;p.innerHTML=s;f.appendChild(p);var m=document.createElement(b);m.className="descriptionDiv";m.innerHTML=e.description;f.appendChild(m)}function r(a){var b=a.param.video;p(b)}function m(){MsnVideo2.addMessageReceiver({eventType:"currentVideoChanged",widgetId:h,widgetGroup:j,funcCb:r});var b=MsnVideo2.getProperties({type:"currentVideo",widgetId:h,widgetGroup:j});if(a!=b&&b.length>0)p(b[0].param.video);if("function"==typeof l)l()}};if(!window.Msn.Video.OverlayPlayerLookup)Msn.Video.OverlayPlayerLookup={};Msn.Video.OverlayPlayer=function(){var bb="onresize",ab="playlistCompleted",C="queueVideo",Z="stopVideo",Y="playVideo",X="/image.aspx?w=128&h=72&so=4&uuid=",k="block",u="true",W="OverlayPlayer",V="widgetId",t="px",f="none",U="undefined",B="widgetGroup",d="player",b=true,a=false,c=null,N=this,lb=N,mb=c,e,i,G,ob,s,m,g,h,M,w,hb=a,q,D,r,j,yb=680,Xb=829,A=a,Vb=640,tb=a,I,fc=135,jc,gb,p=c,nb=a,x,S,P,n,eb,Q,K,z,Wb,Rb,jb,qb,ib=["ad","adpartial","adfull","timeplaying","videosplayed","timeelapsed","playadafterfirstvid","playadbeforefirstvid"],E=[],cb=0,O,Mb=b,R=a,sb=a,rb=a,vb=a,o,db,H=a,Hb,Bb,Jb,Ob,Lb,Nb,Sb,J;N.create=function(a){h=a;if(!checkDefined(a.cfgMgr))Msn.Video.loadConfiguration(a,d,"gmt",Gb);else Gb(c,a,c)};function Gb(ib,lb){var R="leadWithPlugin",O="descriptionDiv",N="titleDiv",L="/i/overlayplayer/close_btn.png",J="adSkinDiv",H="click to close",F="clickToClose",a="DIV",E="MsnVideoInitializeInternal";M=lb.cfgMgr||new Msn.Video.ConfigMgr(ib.configs,h.flashvars,d);w=lb.resMgr||new Msn.Video.ResourceMgr(ib.resources);i=M.getValue(B,c);var cb=checkString(i)?i:"*";if(!Msn.Video.OverlayPlayerLookup.hasOwnProperty(cb)){Msn.Video.OverlayPlayerLookup[cb]="created";e=h.widgetId;s=e+"GalleryInternalGroup";g=e+"PlayerInternalGroup";m=e+"InternalPlayer";G=e+"InternalGallery";ob=G+"Div";if(U!=typeof MsnVideo2&&c!=MsnVideo2)zb();else{mb=window[E];window[E]=zb;var nb=Msn.Video.UrlHelper.getWERoot(h);Msn.Video.JavascriptApi.fetchScript(nb+"/js/widgetframework.js","OverlayPlayerWidgetFramework")}Cb();q=document.createElement(a);q.style.display=f;q.className="msnVideoOverlayPlayer";D=document.createElement(a);D.className="overlayDiv";D.onclick=kb;D.title=w.getValue(d,F,H);q.appendChild(D);r=document.createElement(a);r.className="centerDiv";r.onclick=kb;var T=document.createElement(a);T.className="positionAdj";r.appendChild(T);q.appendChild(r);o=document.createElement(a);db=e+J;o.id=db;o.className=J;o.title="";o.onclick=Tb;T.appendChild(o);j=document.createElement(a);j.className="contentWrapper";j.style.width=yb+t;j.title="";j.onclick=Tb;T.appendChild(j);var jb=Msn.Video.UrlHelper.getWERoot(h),k;k=document.createElement(a);if(checkDefined(k.style.filter)){k.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src = '"+jb+L+"', sizingMethod = 'scale')";k.style.backgroundImage=f}else{k=document.createElement("IMG");k.src=jb+L}k.className="closeImg";k.onclick=kb;k.title=w.getValue(d,F,H);j.appendChild(k);var y=document.createElement(a);y.className="leftContainer";j.appendChild(y);var X=document.createElement(a);X.className="playerDiv";X.style.width=Vb+t;var gb=e+"_playerDiv";X.id=gb;y.appendChild(X);x=document.createElement(a);x.className="metadataWrapper";x.style.display=f;var Z=document.createElement("TABLE");Z.className="metadataTable";var fb=document.createElement("TBODY"),bb=document.createElement("TR"),p=document.createElement("TD");S=document.createElement(a);S.className=N;p.appendChild(S);P=document.createElement(a);P.className=O;p.appendChild(P);bb.appendChild(p);p=document.createElement("TD");p.className="overlayAdCell";var ab=document.createElement(a),hb=e+"adDiv";ab.id=hb;ab.className="overlayAdDiv";p.appendChild(ab);bb.appendChild(p);fb.appendChild(bb);Z.appendChild(fb);x.appendChild(Z);y.appendChild(x);n=document.createElement(a);n.className="upNextWrapper";n.style.display=f;var A=document.createElement(a);A.className="countdown";A.appendChild(document.createTextNode(w.getValue(d,"EndSlateUpNext","UP NEXT").toUpperCase()));A.appendChild(document.createElement("BR"));z=document.createElement(a);z.className="count";A.appendChild(z);n.appendChild(A);K=document.createElement("IMG");K.className="thumbImg";n.appendChild(K);var C=document.createElement(a);C.className="upNextMeta";eb=document.createElement(a);eb.className=N;C.appendChild(eb);Q=document.createElement(a);Q.className=O;C.appendChild(Q);n.appendChild(C);y.appendChild(n);var Y=document.createElement(a);Y.className="rightContainer";j.appendChild(Y);I=document.createElement(a);I.id=ob;I.className="galleryDiv";Y.appendChild(I);Fb();document.body.appendChild(q);var b=Pb(h.flashvars,d);l(b,V,m);l(b,B,g);l(b,"rst",W);l(b,"adDivs",db+"|960|600;"+hb+"|300|60");v(b,"ap",u);v(b,"rvp",u);v(b,"slatetime","0");v(b,"hideplaylist",u);v(b,"initPanel",f);if(c==M.getValue(R,c))v(b,R,"silverlight");Msn.Video.createWidget2({divId:gb,src:d,w:Vb,h:360,flashvars:b,widgetId:m,weRoot:h.weRoot,cacheBuster:h.cacheBuster})}}function F(b,a){clearInterval(Wb);clearInterval(Rb);if(hb){if(b)x.style.display=k;else x.style.display=f;if(a){n.style.display=k;Wb=setInterval(cc,500)}else{n.style.display=f;y(z,"")}}}function cc(){var a=MsnVideo2.getProperties({type:"currentAdPosition",sourceId:e,sourceGroup:g});if(c!=a&&a.length>0){var d=a[0].param.duration-a[0].param.position;if(!isNaN(d))if(d>=1)y(z,parseInt(d));else{y(z,"");H=b;Qb()}}}function ec(c){var e=M.getValue(c,"");if(checkString(e)){var b=e.split("|");for(var a=0;a<b.length;a++)if(a<E.length)E[a][c]=b[a];else{var d={};d[c]=b[a];E.push(d)}}}function Cb(){E=[];for(var a=0;a<ib.length;a++)ec(ib[a])}function hc(f,e){var c=a,d=f[e];if(checkDefined(d)){M.setValue(e,d);c=b}return c}N.onSetConfigs=function(b){if(checkDefined(b)&&checkDefined(b.param)&&checkDefined(b.param.configs)){var c=Zb(b.param.configs),e=a;for(var d=0;d<ib.length;d++)e|=hc(c,ib[d]);if(e)Cb();Hb=c["gallery.categoryrequests"]||c["categoryrequests"]}};function Ub(){if(cb<E.length){MsnVideo2.sendMessage({type:"setAdvertisingOptions",targetId:m,targetGroup:g,param:E[cb]});cb++}}function Tb(a){if(!a)a=window.event;a.cancelBubble=b;if(a.stopPropagation)a.stopPropagation()}function y(a,b){if(checkDefined(a.innerText))a.innerText=b;else a.textContent=b}function fb(b,a){y(S,b);y(P,a);y(eb,b);y(Q,a)}function Kb(a){var f="loading ...",e="loadingMetaData",c="cannot load metadata",b="errorMetaData";if(a.isFailed){fb(w.getValue(d,b,c),w.getValue(d,b,c));Rb=setInterval(kb,5e3)}else{if(a.isReady){fb(a.title,a.description);K.src=Msn.Video.UrlHelper.getVCImgRoot(h)+X+a.uuid}else fb(w.getValue(d,e,f),w.getValue(d,e,f));MsnVideo2.sendMessage({type:Y,targetId:m,targetGroup:g})}}function Ab(b){F(a,a);var c=b.param.video;gb=c;Kb(c);b.sourceGroup=i;b.targetGroup=i;MsnVideo2.sendMessage(b);b.sourceGroup=s;b.targetGroup=s;MsnVideo2.sendMessage(b)}function Yb(h){var e="adplaying",d="videoplaying",c="videoopening",f=h.param.status.toLowerCase();if(!hb)switch(f){case c:case "videobuffering":case d:case "adopening":case e:MsnVideo2.sendMessage({type:Z,targetId:m,targetGroup:g})}switch(f){case c:sb=a;break;case d:R=b;H=b;if(O){Ub();O=a}F(b,a);T();break;case e:vb=b;if(!R)F(a,b);if(sb)bc();break;case "adplaycompleted":case "adplayfailed":Ib();break;case "videoplaycompleted":case "videoplayfailed":sb=b;H=b;T();break;case "playbackcompleted":case "playbackstopped":Mb=a;R=a;O=b}ub();Qb()}function gc(a){if(a.param.id==db){rb=b;ub()}}function dc(){T()}function bc(){if(c!=p){fb(p.title,p.description);F(a,b);K.src=Msn.Video.UrlHelper.getVCImgRoot(h)+X+p.uuid}}function Db(){if(c!=p){MsnVideo2.sendMessage({type:C,targetId:m,targetGroup:g,param:{video:p}});p=c}else{nb=b;T()}}var pb=a;function T(){if(c==p){pb=b;MsnVideo2.sendMessage({type:ab,sourceId:e,sourceGroup:s,targetId:G,targetGroup:s})}}function ac(b){if(b.type.toLowerCase()=="queuevideo"&&pb){pb=a;p=b.param.video;if(nb){nb=a;Db()}}else{b.targetGroup=g;MsnVideo2.sendMessage(b)}}function Ib(){vb=a;rb=a}function ub(){if(checkDefined(o))if(rb&&vb)o.style.display=k;else o.style.display=f}function Fb(){Bb=document.documentElement.style.overflow;Jb=document.body.style.overflow;Ob=document.body.style.margin;Lb=document.body.style.padding;Nb=document.body.style.height;Sb=document.body.style.width;var a=document.body;J=a.scrollTop;if(0==J)if(window.pageYOffset)J=window.pageYOffset;else J=a.parentElement?a.parentElement.scrollTop:0}function ic(){hb=b;Fb();D.style.display=k;q.style.display=k;MsnVideo2.sendMessage({type:"overlayOpened",sourceGroup:i,targetGroup:i});document.body.style.margin="0px";document.body.style.padding="0px";document.body.style.height="100%";document.body.style.width="100%";if(!wb()){document.documentElement.style.overflow="hidden";document.documentElement.style.minWidth="1024";document.documentElement.style.minHeight="768";document.body.style.overflow="hidden";window.scroll(0,0)}if(window.attachEvent)window.attachEvent(bb,L);else window.addEventListener("resize",L,a);L();qb=a}function kb(){hb=a;document.body.style.margin=Ob;document.body.style.padding=Lb;document.body.style.height=Nb;document.body.style.width=Sb;if(!wb()){document.documentElement.style.overflow=Bb;document.body.style.overflow=Jb;window.scroll(0,J)}if(!xb()||A)q.style.display=f;else qb=b;if(wb()||xb())A=a;jb={type:Z,targetId:m,targetGroup:g};if(A)MsnVideo2.sendMessage(jb);j.style.width=yb+t;F(a,a);Mb=b;R=a;H=a;Ib();ub();if(window.detachEvent)window.detachEvent(bb,L);else window.removeEventListener("resize",L,a);if(U!=typeof MsnVideo2)MsnVideo2.sendMessage({type:"overlayClosed",sourceGroup:i,targetGroup:i})}function L(){var c=document.documentElement,b=document.body,a=Math.min(b.clientHeight,c.clientHeight);if(a<600){r.style.top="10px";r.style.marginTop="0px"}else{r.style.top="50%";r.style.marginTop="-400px"}}function Eb(a){cb=0;Ub();O=b;a.targetId=m;a.targetGroup=g;MsnVideo2.sendMessage(a)}N.onLoadVideo=function(b){gb=c;tb=a;I.innerHTML="";if(!A)jb=b;else Eb(b);ic()};N.onPlayerLoaded=function(){A=b;Eb(jb);if(xb()&&qb){q.style.display=f;A=a}};function Qb(){if(!tb&&c!=gb&&H){j.style.width=Xb+t;var d=Hb||encodeURI("RelatedVideos.aspx?uuids="+gb.uuid+"&mk=us&alg=0&ff=81&ind=3&ps=12&rct=1,2,3,4,5,6"),a=Pb(h.flashvars,"gallery");l(a,"configcsid","MSNvideo");l(a,"configname","divoverlaygallery");l(a,V,G);l(a,B,s);l(a,"rst",W);l(a,"playtype","inline");v(a,"gallery.categoryRequests",d);v(a,"cp",u);Msn.Video.createWidget2({divId:ob,src:"gallery",w:fc,h:455,flashvars:a,widgetId:G,weRoot:h.weRoot,cacheBuster:h.cacheBuster});tb=b}}function zb(){var b="widgetLoaded",a="loadVideo";MsnVideo2.addMessageReceiver({eventType:a,widgetId:e,widgetGroup:i,funcCb:lb.onLoadVideo});MsnVideo2.addMessageReceiver({eventType:C,widgetId:e,widgetGroup:i,funcCb:lb.onLoadVideo});MsnVideo2.addMessageReceiver({eventType:"setConfigs",widgetId:e,widgetGroup:i,funcCb:lb.onSetConfigs});MsnVideo2.addMessageReceiver({eventType:b,widgetId:e,widgetGroup:g,funcCb:lb.onPlayerLoaded});MsnVideo2.addMessageReceiver({eventType:"currentVideoChanged",widgetId:e,widgetGroup:g,funcCb:Ab});MsnVideo2.addMessageReceiver({eventType:"playbackStatusChanged",widgetId:e,widgetGroup:g,funcCb:Yb});MsnVideo2.addMessageReceiver({eventType:"companionAdRendered",widgetId:e,widgetGroup:g,funcCb:gc});MsnVideo2.addMessageReceiver({eventType:ab,widgetId:e,widgetGroup:g,funcCb:Db});var h=[C,a,Y];for(var f=0;f<h.length;f++)MsnVideo2.addMessageReceiver({eventType:h[f],widgetId:e,widgetGroup:s,funcCb:ac});MsnVideo2.addMessageReceiver({eventType:b,widgetId:e,widgetGroup:s,funcCb:dc});MsnVideo2.addMessageReceiver({eventType:"currentVideoDataUpdated",widgetId:e,widgetGroup:g,funcCb:Ab});var d=MsnVideo2.getProperties({type:"currentVideo",sourceId:e,sourceGroup:g});if(c!=d&&d.length>0)Kb(d[0].param.video);if("function"==typeof mb)mb()}function l(a,b,c){a[b.toLowerCase()]=c}function v(b,a,c){a=a.toLowerCase();if(!checkString(b[a]))b[a]=c}function Zb(b){var a={};for(var c in b)a[c.toLowerCase()]=b[c];return a}function Pb(c,a){var e={};a=a.toLowerCase()+".";for(var d in c){var b=d.toLowerCase();if(b.indexOf(a)>=0||b.indexOf(".")<0)e[b.replace(a,"")]=c[d]}return e}function wb(){return navigator.userAgent.toLowerCase().indexOf("firefox")>=0}function xb(){return navigator.userAgent.toLowerCase().indexOf("chrome")>=0}};Msn.Video.LeadWithImagePlayers=[];Msn.Video.LeadWithImage=function(){var h="block",b="none",g="player",f=null,o=this,k=f,a,i,l,n,e,c,d,j;this.create=function(b,d){a=b;n=d;i=b.cfgMgr;l=b.resMgr;var c=q();if(c)t(c.uuid)};function t(d){var c=Msn.Video.UrlHelper.getVCERoot(a),b=c+"/videoByUuid.aspx?uuid="+d+"&responseEncoding=json";Msn.Video.JavascriptApi.makeRequest(b,f,u)}function u(D,M,L){var t="IMG",C="MsnVideoInitializeInternal",s="px",h="DIV",u=document.createElement(h);u.className="msnLeadWithImage";n.appendChild(u);var q=i.getValue("leadWithImageWidth",getCreateWidgetParamValue(a,"w",640)),A=i.getValue("leadWithImageHeight",getCreateWidgetParamValue(a,"h",360));if(!D){u.style.width=""+q+s;u.style.height=""+A+s;var L=l.getValue(g,"ErrorUnavailable","Video unavailable");u.appendChild(document.createTextNode(L));return}if("undefined"!=typeof MsnVideo2&&f!=MsnVideo2)m();else{j=false;k=window[C];window[C]=m}var I=document.createElement(h);I.className="headerDiv";u.appendChild(I);e=document.createElement(h);e.className="closeBtnDiv";e.style.display=b;e.onclick=o.hidePlayer;I.appendChild(e);var E=Msn.Video.UrlHelper.getWERoot(a),H=document.createElement(t);H.src=E+"/i/leadWithImage/close_btn.png";H.className="closeBtn";e.appendChild(H);var B=document.createElement(t);B.src=E+"/i/leadWithImage/close_btn_hover.png";B.className="closeBtnHover";B.style.display=b;e.appendChild(B);c=document.createElement(h);c.className="imageDiv";c.style.width=q+s;c.style.height=A+s;c.onclick=r;u.appendChild(c);var G=document.createElement(h);G.className="thumbnailDiv";c.appendChild(G);var y=document.createElement(t);y.className="thumbnail";y.src=p(D.uuid.$,q,A);y.width=q;y.height=A;G.appendChild(y);var K=document.createElement(h);K.className="clear";c.appendChild(K);var z=A*.4,w=document.createElement(h);w.className="playBtnDiv";w.style.left=(q-z)/2+s;c.appendChild(w);var x=document.createElement(t);x.src=E+(q>600?"/i/leadWithImage/135x135_play_overlay.png":"/i/leadWithImage/70x70_play_overlay.png");x.width=z;x.height=z;x.className="playBtn";w.appendChild(x);var v=document.createElement(t);v.src=E+(q>600?"/i/leadWithImage/135x135_play_overlay_hover.png":"/i/leadWithImage/70x70_play_overlay_hover.png");v.width=z;v.height=z;v.style.display=b;v.className="playBtnHover";w.appendChild(v);var F=document.createElement(h);F.className=q>600?"titleBackgroundWide":q<=300?"titleBackgroundNarrow":"titleBackground";F.innerHTML=D.title.$;c.appendChild(F);var J=document.createElement(h);J.className=q>600?"titleWide":q<=300?"titleNarrow":"title";J.innerHTML=D.title.$;c.appendChild(J);d=document.createElement(h);d.className="playerDiv";d.id=getCreateWidgetParamValue(a,"widgetId","")+"PlayerDiv";d.style.display=b;d.innerHTML=g;u.appendChild(d);Msn.Video.LeadWithImagePlayers.push(o)}function r(){if(d.innerHTML==g){d.innerHTML="";a.flashvars["ap"]="true";Msn.Video.createWidget2({divId:d.id,src:a.src,w:a.w,h:a.h,flashvars:a.flashvars,widgetId:a.widgetId,root:a.root,weRoot:a.weRoot,vceRoot:a.vceRoot,cacheBuster:a.cacheBuster,cfgMgr:i,refMgr:l})}var f=Msn.Video.LeadWithImagePlayers.length;while(f-->0)Msn.Video.LeadWithImagePlayers[f].hidePlayer();c.style.display=b;d.style.display=h;e.style.display=h;if(j)MsnVideo2.sendMessage({type:"playVideo",targetId:a.widgetId});else _playPending=true}this.hidePlayer=function(){if(j)MsnVideo2.sendMessage({type:"pauseVideo",targetId:a.widgetId});c.style.display=h;d.style.display=b;e.style.display=b};VCQueryType={Uuid:1,Csid:2,Market:3,Tag:4,Search:5,Related:6,Random:7};function s(a){var b=a,c=""}function q(){var a=f,e=i.getValue("c","v");switch(e){case "v":a=new s(VCQueryType.Uuid);var d=i.getValue("v","").split(",");for(var c=0;c<d.length;++c){var b=d[c];if(b&&b.length>0){a.uuid=b;break}}}return a}function p(b,e,d){if(e<=0||d<=0||b==f||b.length==0)return "";var c=e*10>=d*16,i=c?16:4,j=c?9:3,g=Math.round(Math.min(Math.min(e,800)/i,d/j)),h="?uuid="+b+"&w="+g*i+"&h="+g*j;if(c)h+="&so=4";var k=Msn.Video.UrlHelper.getVCImgRoot(a);return k+"/image.aspx"+h}function m(){j=true;if("function"==typeof k)k()}}