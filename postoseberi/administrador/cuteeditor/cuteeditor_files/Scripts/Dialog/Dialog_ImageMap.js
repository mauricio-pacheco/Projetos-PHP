var OxO307e=["contains","parentNode","selection","document","type","None","Text","body","rangeCount","window","Control","anchorOffset","childNodes","anchorNode","isCollapsed","focusNode","length","nodeType","nodeName","INPUT","TEXTAREA","BUTTON","IMG","SELECT","TABLE","position","style","absolute","relative","top","contentWindow","contentDocument","parentWindow","id","frames","frameElement","//TODO:frame contentWindow not found?","iframe","editor","img","onload","src","","src_cetemp","contentEditable","designMode","on","clearAttributes","marginTop","0","marginLeft","color","black","background","white","unselectable","2D-Position","LiveResize","innerHTML","outerHTML","MAP","name","useMap","#","areas","href","target","alt","coords",",","\x3Cimg id=\x27myIMAGE","\x27 border=1 src=\x27Images/space.gif\x27 title=\x27","\x27 style=\x27position:absolute;left:","px;top:","px;width:","px;height:","px;z-index:","\x27\x3E","MapLink.php","dialogWidth:380px;dialogHeight:200px;help:no;scroll:no;status:no;resizable:0;","zoom","width","height","\x27  border=1 src=\x27Images/space.gif\x27 title=\x27","\x27 style=\x27position:absolute;z-index:",";width:20;height:20;left:",";top:","myIMAGE","\x3Carea shape=\x27rect\x27 coords=\x27","\x27","href=\x27","\x27 ","target=\x27","alt=\x27","\x3E","PasteHTML","\x3Cmap name=\x27","\x3C/map\x3E","off","AutoMap","display","img_zoom_in","none","img_zoom_out","img_bestfit","img_actualsize"];function Element_Contains(element,Ox29c){if(!Browser_IsOpera()){if(element[OxO307e[0]]){return element.contains(Ox29c);} ;} ;for(;Ox29c!=null;Ox29c=Ox29c[OxO307e[1]]){if(element==Ox29c){return true;} ;} ;return false;} ;function Window_CreateSelectionRange(Ox2c3){var Ox342;if(Browser_UseIESelection()){var Ox259=Ox2c3[OxO307e[3]][OxO307e[2]];if(Ox259[OxO307e[4]]==OxO307e[5]||Ox259[OxO307e[4]]==OxO307e[6]){Ox342=Ox259.createRange();} else {Ox342=document[OxO307e[7]].createTextRange();Ox342.moveToElement(Ox259.createRange().item(0));} ;} else {var Ox259=Ox2c3.getSelection();if(Ox259[OxO307e[8]]==0){Ox342=Ox2c3[OxO307e[3]].createRange();} else {Ox342=Ox259.getRangeAt(0).cloneRange();} ;} ;Ox342[OxO307e[9]]=Ox2c3;return Ox342;} ;function Window_GetSelectionNode(Ox2c3){var Ox29c=Window_GetSelectionNode_Core(Ox2c3);if(Ox29c==Ox2c3[OxO307e[3]][OxO307e[7]]){return null;} ;if(!Element_Contains(Ox2c3[OxO307e[3]].body,Ox29c)){return null;} ;return Ox29c;} ;function Window_GetSelectionNode_Core(Ox2c3){var Ox259;if(Browser_UseIESelection()){Ox259=Ox2c3[OxO307e[3]][OxO307e[2]];if(Ox259[OxO307e[4]]==OxO307e[5]||Ox259[OxO307e[4]]==OxO307e[6]){return Ox259.createRange().parentElement();} ;return Ox259.createRange().item(0);} ;var Ox259=Ox2c3.getSelection();if(Window_GetSelectionType(Ox2c3)==OxO307e[10]){return Ox259[OxO307e[13]][OxO307e[12]][Ox259[OxO307e[11]]];} ;if(Ox259[OxO307e[14]]){return Ox259[OxO307e[13]];} ;if(Ox259[OxO307e[13]]==Ox259[OxO307e[15]]){return Ox259[OxO307e[13]];} ;var p=Ox259[OxO307e[13]];var Oxc=p[OxO307e[12]];for(var i=0;i<Oxc[OxO307e[16]];i++){var Ox35f=Oxc.item(i);if(Ox259.containsNode(Ox35f,true)){if(i!=0&&Ox259.containsNode(Oxc.item(i-1),false)){continue ;} ;if(i<Oxc[OxO307e[16]]-1&&Ox259.containsNode(Oxc.item(i+1),false)){continue ;} ;return Ox35f;} ;} ;if(Ox259[OxO307e[8]]==1){return Range_GetParentNode(Window_CreateSelectionRange(Ox2c3));} ;if(!Element_Contains(Ox2c3[OxO307e[3]].body,Ox259.anchorNode)){return null;} ;return Element_GetSameParent(Ox259.anchorNode,Ox259.focusNode);} ;function Window_GetSelectionElement(Ox2c3){var Ox29c=Window_GetSelectionNode(Ox2c3);if(Ox29c==null){return null;} ;if(Ox29c[OxO307e[17]]==1){return Ox29c;} ;return Ox29c[OxO307e[1]];} ;function Window_GetSelectionType(Ox2c3){if(Browser_UseIESelection()){return Ox2c3[OxO307e[3]][OxO307e[2]][OxO307e[4]];} ;var Ox259=Ox2c3.getSelection();if(Ox259[OxO307e[14]]){return OxO307e[6];} ;if(Ox259[OxO307e[13]]!=Ox259[OxO307e[15]]){return OxO307e[6];} ;var p=Ox259[OxO307e[13]];var Oxc=p[OxO307e[12]];for(var i=0;i<Oxc[OxO307e[16]];i++){var Ox35f=Oxc.item(i);if(Ox35f[OxO307e[17]]!=1){continue ;} ;if(Ox259.containsNode(Ox35f,true)){if(i!=0&&Ox259.containsNode(Oxc.item(i-1),false)){continue ;} ;if(i<Oxc[OxO307e[16]]-1&&Ox259.containsNode(Oxc.item(i+1),false)){continue ;} ;if(Element_IsBlockControl(Ox35f)){return OxO307e[10];} ;return OxO307e[6];} ;} ;return OxO307e[6];} ;function Element_IsBlockControl(element){var name=element[OxO307e[18]];if(name==OxO307e[19]){return true;} ;if(name==OxO307e[20]){return true;} ;if(name==OxO307e[21]){return true;} ;if(name==OxO307e[22]){return true;} ;if(name==OxO307e[23]){return true;} ;if(name==OxO307e[24]){return true;} ;var Ox228=element[OxO307e[26]][OxO307e[25]];if(Ox228==OxO307e[27]||Ox228==OxO307e[28]){return true;} ;return false;} ;function Window_GetDialogTop(Ox2c3){return Ox2c3[OxO307e[29]];} ;function Frame_GetContentWindow(Ox46c){if(Ox46c[OxO307e[30]]){return Ox46c[OxO307e[30]];} ;if(Ox46c[OxO307e[31]]){if(Ox46c[OxO307e[31]][OxO307e[32]]){return Ox46c[OxO307e[31]][OxO307e[32]];} ;} ;var Ox2c3;if(Ox46c[OxO307e[33]]){Ox2c3=window[OxO307e[34]][Ox46c[OxO307e[33]]];if(Ox2c3){return Ox2c3;} ;} ;var len=window[OxO307e[34]][OxO307e[16]];for(var i=0;i<len;i++){Ox2c3=window[OxO307e[34]][i];if(Ox2c3[OxO307e[35]]==Ox46c){return Ox2c3;} ;if(Ox2c3[OxO307e[3]]==Ox46c[OxO307e[31]]){return Ox2c3;} ;} ;Debug_Todo(OxO307e[36]);} ;var iframe=Window_GetElement(window,OxO307e[37],true);var iframe_win=Frame_GetContentWindow(iframe);var obj=Window_GetDialogArguments(window);var editor=obj[OxO307e[38]];var editwin=obj[OxO307e[9]];var editdoc=obj[OxO307e[3]];var oImg=obj[OxO307e[39]];var oMap=null;var aMapName= new Array();var aLeft= new Array();var aTop= new Array();var aWidth= new Array();var aHeight= new Array();var aHref= new Array();var aTarget= new Array();var aTitle= new Array();var aCoords= new Array();window[OxO307e[40]]=function window_onload(){var src;src=oImg.getAttribute(OxO307e[41])+OxO307e[42];if(oImg.getAttribute(OxO307e[43])){src=oImg.getAttribute(OxO307e[43])+OxO307e[42];} ;oImg[OxO307e[41]]=src;if(Browser_IsWinIE()){iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[44]]=true;} else {iframe_win[OxO307e[3]][OxO307e[45]]=OxO307e[46];iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[44]]=true;} ;iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[47]];iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[48]]=OxO307e[49];iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[50]]=OxO307e[49];iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[51]]=OxO307e[52];iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[53]]=OxO307e[54];oImg[OxO307e[55]]=OxO307e[46];if(Browser_IsWinIE()){iframe_win[OxO307e[3]].execCommand(OxO307e[56],true,true);iframe_win[OxO307e[3]].execCommand(OxO307e[57],true,true);} ;iframe_win.focus();if(Browser_IsWinIE()){iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[58]]=oImg[OxO307e[59]];} else {iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[58]]=outerHTML(oImg);} ;var Ox47a=editdoc[OxO307e[7]].getElementsByTagName(OxO307e[60]);for(var i=0;i<Ox47a[OxO307e[16]];i++){aMapName[i]=Ox47a[i][OxO307e[61]].toUpperCase();} ;var Ox47b=oImg[OxO307e[62]];if(Ox47b!=OxO307e[42]){Ox47b=Ox47b.toUpperCase();for(var i=0;i<Ox47a[OxO307e[16]];i++){if((OxO307e[63]+aMapName[i])==Ox47b){oMap=Ox47a[i];} ;} ;} ;if(oMap){for(var i=0;i<oMap[OxO307e[64]][OxO307e[16]];i++){aHref[i]=oMap[OxO307e[64]][i][OxO307e[65]];aTarget[i]=oMap[OxO307e[64]][i][OxO307e[66]];aTitle[i]=oMap[OxO307e[64]][i][OxO307e[67]];aCoords[i]=oMap[OxO307e[64]][i][OxO307e[68]];var Ox1b=aCoords[i].split(OxO307e[69]);aLeft[i]=parseInt(Ox1b[0]);aTop[i]=parseInt(Ox1b[1]);aWidth[i]=parseInt(Ox1b[2])-aLeft[i];aHeight[i]=parseInt(Ox1b[3])-aTop[i];iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[58]]+=OxO307e[70]+i+OxO307e[71]+AddLinktoImageMap+OxO307e[72]+aLeft[i]+OxO307e[73]+aTop[i]+OxO307e[74]+aWidth[i]+OxO307e[75]+aHeight[i]+OxO307e[76]+(i+1)+OxO307e[77];} ;} ;} ;function SearchSelectionElement(Ox47d){var body=iframe_win[OxO307e[3]][OxO307e[7]];for(var Ox272=Window_GetSelectionElement(iframe_win);Element_Contains(body,Ox272);Ox272=Ox272[OxO307e[1]]){if(Ox272[OxO307e[18]]==Ox47d){return Ox272;} ;} ;return null;} ;function Addlink(){var img=SearchSelectionElement(OxO307e[22]);if(!img){return ;} ;function Ox481(arr){if(arr){aHref[Ox483]=arr[0];aTarget[Ox483]=arr[1];aTitle[Ox483]=arr[2];} ;} ;var Ox482=img[OxO307e[33]];var Ox483=parseInt(Ox482.substr(7));var obj={editor:editor,href:aHref[Ox483],target:aTarget[Ox483],title:aTitle[Ox483]};editor.SetNextDialogWindow(window);editor.ShowDialog(Ox481,OxO307e[78]+query_string,obj,OxO307e[79]);} ;function do_Close(){Window_SetDialogReturnValue(window,null);Window_CloseDialog(window);} ;function Zoom_In(){if(iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[80]]!=0){iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[80]]*=1.2;} else {iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[80]]=1.2;} ;} ;function Zoom_Out(){if(iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[80]]!=0){iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[80]]*=0.8;} else {iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[80]]=0.8;} ;} ;function BestFit(){if(!oImg){return ;} ;var Ox487=280;var Ox26c=290;iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[80]]=1/Math.max(oImg[OxO307e[81]]/Ox26c,oImg[OxO307e[82]]/Ox487);} ;function Actualsize(){iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[26]][OxO307e[80]]=1;} ;function newMap(){var Ox237=aHref[OxO307e[16]];var Ox48a=(oImg[OxO307e[81]]-20)*0.5;var Ox45e=(oImg[OxO307e[82]]-20)*0.5;aHref[Ox237]=OxO307e[42];aTarget[Ox237]=OxO307e[42];aTitle[Ox237]=OxO307e[42];iframe_win[OxO307e[3]][OxO307e[7]][OxO307e[58]]+=OxO307e[70]+Ox237+OxO307e[83]+AddLinktoImageMap+OxO307e[84]+(Ox237+1)+OxO307e[85]+Ox48a+OxO307e[86]+Ox45e+OxO307e[77];iframe_win.scrollBy(0,0);iframe_win.focus();} ;function do_insert(){var Ox1c=false;for(var i=0;i<aHref[OxO307e[16]];i++){var obj=Window_GetElement(iframe_win,OxO307e[87]+i,false);if(obj){Ox1c=true;} ;} ;if(Ox1c){var Ox3a0=OxO307e[42];for(var i=0;i<aHref[OxO307e[16]];i++){var obj=Window_GetElement(iframe_win,OxO307e[87]+i,false);if(obj){var Ox48b=parseInt(obj[OxO307e[26]].left);var Ox48c=parseInt(obj[OxO307e[26]].top);var Ox48d=parseInt(obj[OxO307e[26]].width);var Ox48e=parseInt(obj[OxO307e[26]].height);var Ox48f=Ox48b+Ox48d;var Ox490=Ox48c+Ox48e;Ox3a0+=OxO307e[88]+Ox48b+OxO307e[69]+Ox48c+OxO307e[69]+Ox48f+OxO307e[69]+Ox490+OxO307e[89];if(aHref[i]!=OxO307e[42]){Ox3a0+=OxO307e[90]+aHref[i]+OxO307e[91];} ;if((aTarget[i]!=OxO307e[42])&&aTarget[i]){Ox3a0+=OxO307e[92]+aTarget[i]+OxO307e[91];} ;if(aTitle[i]!=OxO307e[42]&&aTitle[i]!=null){Ox3a0+=OxO307e[93]+aTitle[i]+OxO307e[91];} ;Ox3a0+=OxO307e[94];} ;} ;if(oMap){oMap[OxO307e[58]]=Ox3a0;} else {var Ox47b=getAutoMapName();oImg[OxO307e[62]]=OxO307e[63]+Ox47b;editor.ExecCommand(OxO307e[95],false,OxO307e[96]+Ox47b+OxO307e[77]+Ox3a0+OxO307e[97]);} ;} else {if(oMap){if(Browser_IsWinIE()){oMap[OxO307e[59]]=OxO307e[42];} ;} ;oImg[OxO307e[62]]=OxO307e[42];} ;oImg[OxO307e[55]]=OxO307e[98];oImg.removeAttribute(OxO307e[55]);if(!Browser_IsWinIE()){editor.InsertElement(oImg);} ;Window_CloseDialog(window);} ;function getAutoMapName(){for(var i=1;true;i++){var Ox1ee=OxO307e[99]+i;if(isValidMapName(Ox1ee)){return Ox1ee;} ;} ;} ;function isValidMapName(Oxb){Oxb=Oxb.toUpperCase();for(var i=0;i<aMapName[OxO307e[16]];i++){if(aMapName[i]==Oxb){return false;} ;} ;return true;} ;function do_Close(){oImg.removeAttribute(OxO307e[55]);Window_CloseDialog(window);} ;if(!Browser_IsWinIE()){Window_GetElement(window,OxO307e[101],true)[OxO307e[26]][OxO307e[100]]=OxO307e[102];Window_GetElement(window,OxO307e[103],true)[OxO307e[26]][OxO307e[100]]=OxO307e[102];Window_GetElement(window,OxO307e[104],true)[OxO307e[26]][OxO307e[100]]=OxO307e[102];Window_GetElement(window,OxO307e[105],true)[OxO307e[26]][OxO307e[100]]=OxO307e[102];} ;